%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}
\usepackage{nicefrac, xfrac}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Description}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{pySailingVLM Documentation}
\date{Jun 09, 2023}
\release{}
\author{Zuzanna Wieczorek, Grzegorz Gruszczyński}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
 
\clearpage

\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{chapters/intro::doc}}


\sphinxAtStartPar
The beginning of fluid dynamics has started in acient Greece, when Archimedes investigated the fluid statics and bouancy. From that time, many well\sphinxhyphen{}konwn mathematicians and engineers have contributed to defining how air and gases behave. The equations they have constructed are extremely complex and difficult to calculate by hand when the geometry of airfoil is complicated. The rapid improvement of computers’ power in 1970s has led to developing complex flow desings. Over the past few decades Computational Fluid Dynamics (CFD) has been improved dramatically.

\sphinxAtStartPar
There are many methods, that are used in Computational Fluid Dynamics. Some of them are Finite Element Method (FEM), Volume of Fluid (VOF) and Lattice Boltzmann Method (LBM). They provide good and accurate results but require high amount of computational resources. To overcome this problem, low fidelity tools can be used, like Vortex Lattice Method (VLM). Using VLM is benefical in the early conceptual design phase {[}\hyperlink{cite.chapters/bibliography:id9}{NJS+21}{]}, when many different desings should be tested. Thanks to fast computations of aerodynamics forces and pressures, engineers can quickly overview modelled design performance.

\sphinxAtStartPar
In this work, we present the first open source Python package which implements Vortex Lattice Method for initial aerodynamic analysis of upwind sails. Thanks to its light weight requirements, the software can be immediately installed and execuded locally or accessed by cloud environment such as Google Collab. Additionally, package users can define own sail geometries and use pySailingVLM inside custom scripts which makes creating a set of dynamics very convenient.

\sphinxAtStartPar
Keywords: Vortex Lattice Method (VLM), initial sail analysis, yacht engineering, Python Package

\sphinxAtStartPar
Inside documentation:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Description

\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/description/theory::doc}]{\sphinxcrossref{Theory}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/description/coordinates::doc}]{\sphinxcrossref{Coordinate System and Wind}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/description/technology::doc}]{\sphinxcrossref{Technology}}}

\end{itemize}
\end{itemize}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Getting Started

\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/start/installation::doc}]{\sphinxcrossref{Installation}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/usage/usage::doc}]{\sphinxcrossref{Usage}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/validation/validation::doc}]{\sphinxcrossref{Validation}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/future::doc}]{\sphinxcrossref{Future outlooks}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/conclusion::doc}]{\sphinxcrossref{Conclusions}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{chapters/bibliography::doc}]{\sphinxcrossref{Bibliography}}}

\end{itemize}
\end{itemize}

\sphinxstepscope


\part{Description}

\sphinxstepscope


\chapter{Theory}
\label{\detokenize{chapters/description/theory:theory}}\label{\detokenize{chapters/description/theory::doc}}
\sphinxAtStartPar
The Vortex Lattice Method (VLM) is a numerical method used in computational fluid dynamics. VLM models a surface on aircraft as infinite vortices to estimate the lift curve slope, induced drag, and force distribution. The VLM is the extension of Prandtl’s lifting\sphinxhyphen{}line theory that is capable of computing swept and low aspect ratio wings. {[}\hyperlink{cite.chapters/bibliography:id10}{SHR+19}{]}.


\section{Introduction}
\label{\detokenize{chapters/description/theory:introduction}}
\sphinxAtStartPar
Vortex Lattice Method is build on the Potential flow theory. The viscous effects, drag and flow separation in VLM is sufficient for aproximatting ideal flow seen in nature.


\section{Potential flow theory}
\label{\detokenize{chapters/description/theory:potential-flow-theory}}
\sphinxAtStartPar
Potenttial Flow Theory treats external flows around bodies as invicid and irrotational {[}\hyperlink{cite.chapters/bibliography:id6}{Tec05}{]} .The viscous effects are limitted to a thin layer next to the body (boundary layer). Becouse of this and separation phenomena such fluid can be modelled only with small angle of attack. In irrotational flow fluid particles are not rotating.

\sphinxAtStartPar
In Potential Flow Theory, because velocity must satisfy the conservation of mass equation, the Laplace Equation is qoverning:
\begin{equation*}
\begin{split}
\nabla^{2} \phi = 0
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\phi\) is a potentinal function defined as continous function which satisfies the conservation of mass and momentum (incompressible, inviscid and irrational flow).


\chapter{Vortex Lattice Method}
\label{\detokenize{chapters/description/theory:vortex-lattice-method}}
\sphinxAtStartPar
Vortex Lattice Method allows the computation of induced wind. VLM is a panel method where wing or other configuration is modelled by a large number of elementary, quadrilateral panels lying either on the actual aircraft surface, or on some mean surface, or combination thereof. To satisfy boundary conditions VLM uses following elements attached to each panel:
\begin{itemize}
\item {} 
\sphinxAtStartPar
source \sphinxhyphen{} a point from which fluid issues and flows radially outward such that the continuity equation is satisfied everywhere but at the singularity that exists at the source’s center

\item {} 
\sphinxAtStartPar
sink \sphinxhyphen{} a negative source

\item {} 
\sphinxAtStartPar
doublet \sphinxhyphen{}  singularity resulting when a source or a sink of equal strength are made to approach each other such that the product of their strangths and their distance apart remains constant at a preselected finite value in the limit as a distance between them approaches zero

\item {} 
\sphinxAtStartPar
vortex \sphinxhyphen{} an element that generates a circulation, or tangential motion, around its origin

\end{itemize}

\sphinxAtStartPar
Such singularities are defined by specifying functional variation across the panel and its value is set by determinating strength parameters. Such parameters are known after solving appropriate boundary condition equations. When singularity strengts are determinated, the pressure, velocity can be computed{[}\hyperlink{cite.chapters/bibliography:id5}{JJB09}{]}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.8]{{panels}.png}
\caption{Representation of an airplane flowfield by panel (or singularity) methods. Figure taken from {[}\hyperlink{cite.chapters/bibliography:id5}{JJB09}{]} (Fig. 7.22 page 350).}\label{\detokenize{chapters/description/theory:panel-method}}\end{figure}


\section{Vortices}
\label{\detokenize{chapters/description/theory:vortices}}
\sphinxAtStartPar
The vortex theorems for inviscid incompressible flows has been developed by German scientist Hermann von Helmholtz (1821\sphinxhyphen{}1894). The theory is based on the following assumptions {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Flow is inviscid and incompressible

\item {} 
\sphinxAtStartPar
The strength of vortex filament is constant along its length

\item {} 
\sphinxAtStartPar
A vortex filament cannot start or end in a fluid (it must form or closed path or extend to infinity)

\item {} 
\sphinxAtStartPar
The fluid that forms a vortex tube continues to form a vortex tube and the strength of the vortex tube remains constant as the tube moves about.

\end{itemize}


\subsection{Vortex element}
\label{\detokenize{chapters/description/theory:vortex-element}}
\sphinxAtStartPar
Vortex element in 2D is presented on figure \hyperref[\detokenize{chapters/description/theory:vortex}]{\ref{\detokenize{chapters/description/theory:vortex}}}. It is created by placing a rotating cylindrical core in two dimentional flowfield. If the cylinder has a radius \(R\) and a constant angular velocity of \(\omega_y\), then its motion results in a flow with circular streamlines {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.5]{{vort}.png}
\caption{Two dimentional flowfield around a cylindrical core rotating as a rigid body. Figure taken from {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]} (Fig. 2.11 page 34).}\label{\detokenize{chapters/description/theory:vortex}}\end{figure}

\sphinxAtStartPar
The tangential velocity induced is described by equation:
\begin{equation*}
\begin{split}
q_\theta(r) = \frac{\Gamma}{2\pi \cdot r}
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(r\) is described as distance from the vortex core.

\sphinxAtStartPar
If a vortex is located in free\sphinxhyphen{}strem with uniform velocity \(u_\infty\) then the total velocity at the distance \(r\) can be writtes as \(\overrightarrow{u_\infty} + \overrightarrow{q_\theta(r)}\) {[}\hyperlink{cite.chapters/bibliography:id3}{AH13}{]}.


\subsection{Vortex segment}
\label{\detokenize{chapters/description/theory:vortex-segment}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.5]{{vor_seg}.png}
\caption{Vortex segment in three dimentions. Figure taken from {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]} (Fig. 2.16 page 40).}\label{\detokenize{chapters/description/theory:id10}}\end{figure}

\sphinxAtStartPar
The velocity induced by a straight vortex segement (figure \hyperref[\detokenize{chapters/description/theory:id10}]{\ref{\detokenize{chapters/description/theory:id10}}}) in three dimentions with given vortex strength \(\Gamma\) at point \(P(x,y,z)\) is qiven by equation:
\begin{equation}\label{equation:chapters/description/theory:q_finite}
\begin{split}
\overrightarrow{w_{1,2}} = \frac{\Gamma}{4\pi}\frac{\overrightarrow{r_1} \times \overrightarrow{r_2}}{|\overrightarrow{r_1} \times \overrightarrow{r_2}|^2} \left(\frac{\overrightarrow{r_1}}{||\overrightarrow{r_1}||} - \frac{\overrightarrow{r_2}}{||\overrightarrow{r_2}||}\right) \cdot\overrightarrow{r_0}=\overrightarrow{\nu}\,\Gamma
\end{split}
\end{equation}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}
\overrightarrow{r_{0}} = \overrightarrow{r_1} - \overrightarrow{r_2}
\end{split}
\end{equation*}
\sphinxAtStartPar
and
\begin{gather*}
\overrightarrow{r_{0}} = (x_2, y_2, z_2) - (x_1, y_1, z_1) \\
\overrightarrow{r_{1}} = P - (x_1, y_1, z_1)\\
\overrightarrow{r_{2}} = P - (x_2, y_2, z_2)
\end{gather*}
\sphinxAtStartPar
In case of a semi\sphinxhyphen{}infinite vortex line, the point 2 is infinitely far away thus formula reads {[}\hyperlink{cite.chapters/bibliography:id8}{PS00}{]}:
\begin{equation}\label{equation:chapters/description/theory:q_infinite}
\begin{split}
\overrightarrow{w_{1,2}} = \frac{\Gamma}{4\pi}\frac{\overrightarrow{u_\infty} \times \overrightarrow{r_1}}{||\overrightarrow{r_1}||(||\overrightarrow{r_1}|| - \overrightarrow{u_\infty} \cdot \overrightarrow{r_1})}=\overrightarrow{\nu}\,\Gamma
\end{split}
\end{equation}

\section{The Kutta Condition}
\label{\detokenize{chapters/description/theory:the-kutta-condition}}
\sphinxAtStartPar
The Kutta Condition states that at small angle of attack the flow leaves the sharp trailing edge of an airfoil smoothly and the velocity is finite there {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]}. Because of this the normal component of velocity, from both sides of the airfoil, must vanish. Circulation at trailing edge can be expressed by equation:
\begin{equation*}
\begin{split}
\gamma_{T.E.}=0
\end{split}
\end{equation*}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.5]{{kutta}.png}
\caption{Flow near cusped trailing edge. Figure taken from {[}\hyperlink{cite.chapters/bibliography:id4}{JK01}{]} (Fig. 4.12 page 89)}\label{\detokenize{chapters/description/theory:kutta}}\end{figure}


\section{Lifting surface}
\label{\detokenize{chapters/description/theory:lifting-surface}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{siatka}.png}
\caption{Nomenclature of the lattice elements. Figure created by author.}\label{\detokenize{chapters/description/theory:siatka}}\end{figure}

\sphinxAtStartPar
The surface of the object is divided into panels (gray rectanges on figure \hyperref[\detokenize{chapters/description/theory:siatka}]{\ref{\detokenize{chapters/description/theory:siatka}}} ). The total amount of them is a product of number of panels spanwise and chordwise. Vortex element is associated to each one of them (pink rectangles).

\sphinxAtStartPar
There are two types of vortex elements:
\begin{itemize}
\item {} 
\sphinxAtStartPar
vortex ring

\item {} 
\sphinxAtStartPar
vortex horseshoe

\end{itemize}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=400\sphinxpxdimen]{{ring}.png}
\caption{Nomenclature of the vortex ring. Figure created by author.}\label{\detokenize{chapters/description/theory:ring}}\end{figure}

\sphinxAtStartPar
Vortex ring (figure \hyperref[\detokenize{chapters/description/theory:ring}]{\ref{\detokenize{chapters/description/theory:ring}}}) is created by four finite segments according to equation \eqref{equation:chapters/description/theory:q_finite}. Horseshoe vortex is attached to the trailing edge of lifting surface. It consists of three finite and two semi\sphinxhyphen{}infinite segments following equation \eqref{equation:chapters/description/theory:q_finite} and \eqref{equation:chapters/description/theory:q_infinite} (see figure \hyperref[\detokenize{chapters/description/theory:horseshoe}]{\ref{\detokenize{chapters/description/theory:horseshoe}}}). By placing vortex at the quarter chord line of the the two\sphinxhyphen{}dimensional Kutta condition is satisfied along the chord.  Also, along the wing trailing edges, the trailing vortex of the last panel row must be canceled to satisfy the three\sphinxhyphen{}dimensional trailing\sphinxhyphen{}edge condition (see figure \hyperref[\detokenize{chapters/description/theory:tip-vor}]{\ref{\detokenize{chapters/description/theory:tip-vor}}}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=400\sphinxpxdimen]{{horseshoe}.png}
\caption{Nomenclature of the vortex horseshoe. Figure created by author.}\label{\detokenize{chapters/description/theory:horseshoe}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=200\sphinxpxdimen]{{Tip-vortices}.png}
\caption{The total amount of circulation is preserved. Figure 6 from {[}\hyperlink{cite.chapters/bibliography:id7}{Gru21}{]}.}\label{\detokenize{chapters/description/theory:tip-vor}}\end{figure}

\sphinxAtStartPar
When thin surface is angled to a free\sphinxhyphen{}stream \(\overrightarrow{u_{\infty}}\), the aerodynamic force is being generated at center of pressure. This point is located at the \(1/4\) of a panel chord and at \(1/2\) of the panel span (from panel leading edge). To fulfill no flow through the surface, the control point is defined at \(3/4\) of the chord from the panel leading edge and in the middle of the span.

\sphinxAtStartPar
Vortex vertices \(B_k\) and \(C_k\) are placed at \(1/4\) of panel chord (\(v_{k}\)), \(A_k\) and \(D_k\) at \(1/4\) of the next panel (\(v_{k+1}\)). The panel opposite corner points define two vectors \(\overrightarrow{A_k}\) and \(\overrightarrow{B_k}\), and their vector product will point in the direction of \(\overrightarrow{n_k}\) (normal vector).


\subsection{Computations}
\label{\detokenize{chapters/description/theory:computations}}
\sphinxAtStartPar
To converse  which claims that there should be  of the k\sphinxhyphen{}th panel, the equation below is set:

\sphinxAtStartPar
If the velocity induced at k\sphinxhyphen{}th panel is \(\overrightarrow{q_{ind}}\), no flow through the surface (boundary condition) is fulfield when:
\begin{equation}\label{equation:chapters/description/theory:bc}
\begin{split}
(\overrightarrow{u_{\infty}} + \overrightarrow{w_k})\cdot\,\overrightarrow{n_k}=0
\end{split}
\end{equation}
\sphinxAtStartPar
After equation transformation:
\begin{equation}\label{equation:chapters/description/theory:bc2}
\begin{split}
\sum_{j} \overrightarrow{\nu_{kj}}  \, \Gamma_{j} \cdot \overrightarrow{n_k}=-\overrightarrow{u_{\infty}}\,\cdot\,\overrightarrow{n_k}
\end{split}
\end{equation}
\sphinxAtStartPar
where \(\overrightarrow{\nu_{kj}}\) is defined as coefficient of proportionality of induced velocity \(\overrightarrow{q_{ind}}\) at k\sphinxhyphen{}th control point by j\sphinxhyphen{}th vortex.

\sphinxAtStartPar
By expanding equation \eqref{equation:chapters/description/theory:bc} and \eqref{equation:chapters/description/theory:bc2} the RHS coefficient vector can be computed:
\begin{equation*}
\begin{split}
RHS_k=-\overrightarrow{u_{\infty}}\,\cdot\overrightarrow{n_k}
\end{split}
\end{equation*}
\sphinxAtStartPar
In order to obtain gamma magnitude at k\sphinxhyphen{}th panel, the following set of algebraic equations must be solved:
\label{equation:chapters/description/theory:d7f36001-31f4-4697-b729-f9b52cc6ff99}\begin{gather}
    \begin{bmatrix} 
    a_{11} & \dots  & a_{1m}\\
    \vdots & \ddots & \vdots\\
    a_{m1} & \dots  & a_{mm}
    \end{bmatrix}
\begin{bmatrix} 
    \Gamma_{1} \\
    \vdots \\
    \Gamma_{m}
    \end{bmatrix}
 =
  \begin{bmatrix} 
    RHS_{1} \\
    \vdots \\
    RHS_{m}
    \end{bmatrix}
\end{gather}
\sphinxAtStartPar
where \(m=n_{spanwise}\cdot\,n_{chordwise}\) and \(a_{kj} = \overrightarrow{\nu_{kj}} n_k\)

\sphinxAtStartPar
The aerodynamics force can be expressed according to the Kutta\sphinxhyphen{}Joukowski theorem as:
\begin{equation*}
\begin{split}
\overrightarrow{F_{areo}} = \rho \overrightarrow{u_{\infty}} \times \overrightarrow{b} \Gamma
\end{split}
\end{equation*}
\sphinxAtStartPar
Where \(\overrightarrow{b}\) is span vector.

\sphinxAtStartPar
Discretizing, the aerodunamic force corresponding to the j\sphinxhyphen{}th section is:
\begin{equation*}
\begin{split}
\overrightarrow{F_{j}}=\rho\,\overrightarrow{V}_{app\_wind\_fs\_j} \times \overrightarrow{b_j}\Gamma_{j} = \\
\rho(\overrightarrow{V}_{app\_wind\_infs\_j} + \overrightarrow{q}_{ind\_j}) \times \overrightarrow{b_j}\Gamma_{j} = \\
\rho(\overrightarrow{V}_{app\_wind\_infs\_j} +
\sum{\overrightarrow{\nu_{jk}}\Gamma_{k}}) \times \overrightarrow{b_j}\Gamma_{j}
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(b_j\) is a vector representing a finite vortex filement going through the center of pressure of the j\sphinxhyphen{}th section, \(\overrightarrow{V}_{app\_wind\_infs\_j}\) is apparent wind velocity for an ‘infinite sail’ (without induced wind velocity) and \(\overrightarrow{V}_{app\_wind\_fs\_j}\) is apparent wind velocity for a finite sail’ (with induced wind velocity).

\sphinxAtStartPar
Lift is defined as the component of the aerodynamic force that is perpendicular to the flow direction (\(\overrightarrow{u_{\infty}}\)) and can is defined as a dot product of force and normal vector:
\begin{equation*}
\begin{split}
L_k=\overrightarrow{F_k}\,\cdot \overrightarrow{n_k}
\end{split}
\end{equation*}
\sphinxAtStartPar
Pressure at k\sphinxhyphen{}th panel:
\begin{equation*}
\begin{split}
p_k=\frac{L_k}{S_k}
\end{split}
\end{equation*}
\sphinxAtStartPar
Pressure coefficient at k\sphinxhyphen{}th panel can be defined as:
\begin{equation*}
\begin{split}
c_p=\frac{p_k}{\frac{1}{2}\, \rho {\left|\left|\overrightarrow{u_{\infty_k}}\right|\right|}^2}
\end{split}
\end{equation*}


\sphinxstepscope


\chapter{Coordinate System and Wind}
\label{\detokenize{chapters/description/coordinates:coordinate-system-and-wind}}\label{\detokenize{chapters/description/coordinates::doc}}
\sphinxAtStartPar
The surface of the geometry used is defined with coordinates in three dimensions (figure \hyperref[\detokenize{chapters/description/coordinates:geoms}]{\ref{\detokenize{chapters/description/coordinates:geoms}}})  with the x\sphinxhyphen{}axis in the yachts longitudinal (chordwise) direction positive backwards, the y\sphinxhyphen{}axis in the transverse direction positive to starboard and the z\sphinxhyphen{}axis in spanwise direction positive upwards.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=500\sphinxpxdimen]{{geom}.png}
\caption{Sail coordinate system. Figure by author.}\label{\detokenize{chapters/description/coordinates:geoms}}\end{figure}

\sphinxAtStartPar
A boat moves along x\sphinxhyphen{}axis with the \(\overrightarrow{V}_{yacht}\) velocity (figure \hyperref[\detokenize{chapters/description/coordinates:coord-sys}]{\ref{\detokenize{chapters/description/coordinates:coord-sys}}}). The speed of yacht  measured directly from the sailor point of view is desscribed by vectors \(\overrightarrow{V}_{app\_wind\_infs}\) (without induced wind velocity \(\overrightarrow{w}\) ) and \(\overrightarrow{V}_{app\_wind_\fs}\) (with induced wind velocity). An aerodynamic force is generated and is  perpendicular to the apparent wind velocity. The profile of apparent wind is twisted (see figure \hyperref[\detokenize{chapters/description/coordinates:north}]{\ref{\detokenize{chapters/description/coordinates:north}}}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=500\sphinxpxdimen]{{coord_sys}.png}
\caption{Yacht coordinate system. Figure  from {[}\hyperlink{cite.chapters/bibliography:id7}{Gru21}{]} p.18.}\label{\detokenize{chapters/description/coordinates:coord-sys}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Nomenclature}\label{\detokenize{chapters/description/coordinates:coord-table}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{V}_{yacht}\)
&
\sphinxAtStartPar
angle between apparent wind and true wind
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{V}_{app\_wind\_infs\_k}\)
&
\sphinxAtStartPar
apparent wind velocity for an ‘infinite sail’ (without induced wind velocity) acting on k\sphinxhyphen{}th panel
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{V}_{app\_wind\_fs\_k}\)
&
\sphinxAtStartPar
apparent wind velocity for an ‘finite sail’ (with induced wind velocity) acting on k\sphinxhyphen{}th panel
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{V}\_{true\_wind\_k}\)
&
\sphinxAtStartPar
true wind velocity acting on k\sphinxhyphen{}th panel
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{w}\_{k}\)
&
\sphinxAtStartPar
induced wind velocity acting on k\sphinxhyphen{}th panel
\\
\hline
\sphinxAtStartPar
\(\alpha_{app\_infs\_k}\)
&
\sphinxAtStartPar
angle between apparent wind acting on k\sphinxhyphen{}th panel for an ‘infinite sail’ (without induced wind velocity) and direction of boat movement (including leeway)
\\
\hline
\sphinxAtStartPar
\(\alpha_{app\_fs\_k}\)
&
\sphinxAtStartPar
angle between apparent wind of a ‘finite sail’ acting on k\sphinxhyphen{}th panel (with induced wind velocity) and direction of boat movement (including leeway)
\\
\hline
\sphinxAtStartPar
\(\alpha_{ind\_k}\)
&
\sphinxAtStartPar
angle between apparent wind acting on k\sphinxhyphen{}th panel of a ‘finite sail’ (induced wind velocity) and apparent wind of an ‘infinite sail’ (without induced wind velocity)
\\
\hline
\sphinxAtStartPar
\(\alpha_{yacht\_k}\)
&
\sphinxAtStartPar
angle between apparent wind acting on k\sphinxhyphen{}th panel and true wind
\\
\hline
\sphinxAtStartPar
\(\alpha_{true}\)
&
\sphinxAtStartPar
angle between true wind acting on k\sphinxhyphen{}th panel and direction of boat movement with reference to course over ground (i.e. including leeway) {[}deg{]}
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{F}_a\)
&
\sphinxAtStartPar
aerodynamic force acting on k\sphinxhyphen{}th panel
\\
\hline
\sphinxAtStartPar
\(\overrightarrow{T}\)
&
\sphinxAtStartPar
thrust force in direction of boat movement \sphinxhyphen{} Speed Over Ground (SOG)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{North-Sail-Understanding-Twised_wind}.png}
\caption{Profile of apparent wind on sails {[}\hyperlink{cite.chapters/bibliography:id2}{NS18}{]}.}\label{\detokenize{chapters/description/coordinates:north}}\end{figure}

\sphinxAtStartPar
It is worth adding that the induced wind causes extra drag (see figure \hyperref[\detokenize{chapters/description/coordinates:induced-drag}]{\ref{\detokenize{chapters/description/coordinates:induced-drag}}})

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{induced_drag}.png}
\caption{Extra drag generated by induced wind. Figure 6 from {[}\hyperlink{cite.chapters/bibliography:id7}{Gru21}{]}.}\label{\detokenize{chapters/description/coordinates:induced-drag}}\end{figure}

\sphinxstepscope


\chapter{Technology}
\label{\detokenize{chapters/description/technology:technology}}\label{\detokenize{chapters/description/technology::doc}}
\sphinxAtStartPar
The main purpose of the thesis was to optimize the existing code for initial sail analysis.
Orginally the code was implementing many panel objects. Each one of them had many atributes like panel cooridinates, force, pressure, pressure coefficient, span and normal vector. When the size of lattice was increasing, the huge number of objects inside pySailingVLM slowed down the program. To optimize code, the Numba \sphinxhyphen{} JIT compiler that translates Python code and NumPy into machine code which enable parallel coalcuations, was applied. Becouse Numba do not understand custom objects like panel, the code was rewritten using two memory layout approaches.


\section{Memory layout}
\label{\detokenize{chapters/description/technology:memory-layout}}
\sphinxAtStartPar
Array of Structures (AoS) and Structure of Arrays (SoA) are layouts arranging a sequence of records in memory. Structure of Arrays (SoA) layout splits elements of a record into separate units allowing access these elements in parallel. The AoS is the opposite layout in which data for different fields is interleaved. Comparison between conceptual layout and memory layout is shown on figure \hyperref[\detokenize{chapters/description/technology:id2}]{\ref{\detokenize{chapters/description/technology:id2}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{memory_layout}.png}
\caption{Comparison of the Structure of Arrays (SoA) and Arrray of Structure (AoS). Figure 2 from {[}\hyperlink{cite.chapters/bibliography:id11}{PHW+13}{]}}\label{\detokenize{chapters/description/technology:id2}}\end{figure}

\sphinxAtStartPar
The AoS approach ensures that the five values \(a_i, b_i, c_i, d_i, e_i\) are
next to one another in memory, providing good cache utilisation. The SoA approach ensures that these values are split into five separate units, allowing access to corresponding elements in parallel {[}\hyperlink{cite.chapters/bibliography:id11}{PHW+13}{]}.

\sphinxAtStartPar
Simple values like pressure coefficients, forces, pressure acting on each panel were arranged into simple NumPy arrays (SoA). Panel coorditnates, span and normal vectors was rearranged into nested ones (AoS). Figure \hyperref[\detokenize{chapters/description/technology:uklad}]{\ref{\detokenize{chapters/description/technology:uklad}}} shows data layout implemented.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=600\sphinxpxdimen]{{panele.drawio}.png}
\caption{Data layout implemented in pySailingVLM. Figure created by author.}\label{\detokenize{chapters/description/technology:uklad}}\end{figure}


\section{Benchmarks}
\label{\detokenize{chapters/description/technology:benchmarks}}
\sphinxAtStartPar
To benchmark pySalingVLM, the time comparison tests were conducted. Three approaches was summaries in the table \hyperref[\detokenize{chapters/description/technology:benchs}]{\ref{\detokenize{chapters/description/technology:benchs}}}: objective code, ‘non\sphinxhyphen{}objective’,  objective with Numba and ‘non\sphinxhyphen{}objective’ compiled with Numba.  The tests were carried out on a laptop with the following parameters: AMD Ryzen 7 4800H with 8 CPU cores (16 threads), base clock: 2.9 GHz, max boost: 4.2GHz, 32 GB RAM. For 1600 panels more then thirty times acceleration was obtained.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Time execution comparison between different approaches of implementing pySailingVLM depending on sail shape.}\label{\detokenize{chapters/description/technology:benchs}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
No. panels
&\sphinxstyletheadfamily 
\sphinxAtStartPar
objective {[}s{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
‘non\sphinxhyphen{}objective’ {[}s{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
objective + Numba {[}s{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
‘non\sphinxhyphen{}objective’ + Numba {[}s{]}
\\
\hline
\sphinxAtStartPar
100
&
\sphinxAtStartPar
16.51
&
\sphinxAtStartPar
20.0
&
\sphinxAtStartPar
1.71
&
\sphinxAtStartPar
1.04
\\
\hline
\sphinxAtStartPar
400
&
\sphinxAtStartPar
269.13
&
\sphinxAtStartPar
301.39
&
\sphinxAtStartPar
21.81
&
\sphinxAtStartPar
10.41
\\
\hline
\sphinxAtStartPar
600
&
\sphinxAtStartPar
593.85
&
\sphinxAtStartPar
647.96
&
\sphinxAtStartPar
48.44
&
\sphinxAtStartPar
22.51
\\
\hline
\sphinxAtStartPar
1600
&
\sphinxAtStartPar
4325.78
&
\sphinxAtStartPar
4458.05
&
\sphinxAtStartPar
320.54
&
\sphinxAtStartPar
143.69
\\
\hline
\sphinxAtStartPar
2400
&
\sphinxAtStartPar
no data
&
\sphinxAtStartPar
no data
&
\sphinxAtStartPar
724.70
&
\sphinxAtStartPar
320.12
\\
\hline
\sphinxAtStartPar
3600
&
\sphinxAtStartPar
no data
&
\sphinxAtStartPar
no data
&
\sphinxAtStartPar
1653.52
&
\sphinxAtStartPar
706.62
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
According to time results, using Numba is much more efficient when applied to the ‘non\sphinxhyphen{}objective’ code. In order to explain such behaviour the SIMD term should be investigated.


\subsection{SIMD and vectorization}
\label{\detokenize{chapters/description/technology:simd-and-vectorization}}
\sphinxAtStartPar
SIMD stands for Single Instruction Multiple Data. Instead of performing a single instruction on every single data, SIMD uses wider data\sphinxhyphen{}width for similar computational operations {[}\hyperlink{cite.chapters/bibliography:id12}{AS20}{]}. A comparison between simple scalar operation and a SIMD computation is depicted in figure \hyperref[\detokenize{chapters/description/technology:simd-fig}]{\ref{\detokenize{chapters/description/technology:simd-fig}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=200\sphinxpxdimen]{{simd_fig}.png}
\caption{Simple scalar operation (a) and a SIMD computation (b). Figure 1 from {[}\hyperlink{cite.chapters/bibliography:id12}{AS20}{]}.}\label{\detokenize{chapters/description/technology:simd-fig}}\end{figure}

\sphinxAtStartPar
Vectorization with AOS in memory data layout requires multiple load/shuffle/insert or gather instructions. Because of the reduced CPU frequency in SIMD mode its improvements are not sufficient. Increase in vector width demands more instructions for vector construction. A properly aligned memory data layout for vectorization which Numba uses, needs Structure of Arrays (SOA). It provides SIMD compatible memory accesses and results in efficiency and speedup {[}\hyperlink{cite.chapters/bibliography:id13}{WP16}{]}.

\sphinxAtStartPar
Array of Structure memory layout is more appropirate when no vectorization is used because proessing data are next to one another in memory. As a consequence, ‘non\sphinxhyphen{}objective’ code without Numba is slower than objective one (table \hyperref[\detokenize{chapters/description/technology:benchs}]{\ref{\detokenize{chapters/description/technology:benchs}}}).


\section{Other improvements}
\label{\detokenize{chapters/description/technology:other-improvements}}
\sphinxAtStartPar
Apart from code optimizations, the pySailingVLM has gained more features. The possibility to calculate cambered sailis and visualize pressure coefficients on colormap was introduced. Code has been packaged and now is available at Python Package Index (PyPI). It can be run locally from command line or in a cloud using Jupyter Notebook. pySailingVLM can be executed in a user defined script, which make it easy to calculate and compare many sailing cases.

\sphinxstepscope


\part{Getting Started}

\sphinxstepscope


\chapter{Installation}
\label{\detokenize{chapters/start/installation:installation}}\label{\detokenize{chapters/start/installation::doc}}

\section{For Users}
\label{\detokenize{chapters/start/installation:for-users}}
\sphinxAtStartPar
pySailingVLM package is available at PyPI, to install it do:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{pySailingVLM}
\end{sphinxVerbatim}


\section{For Developers}
\label{\detokenize{chapters/start/installation:for-developers}}
\sphinxAtStartPar
If you would like to dive into pySailingVLM code and test it on your own please do the folowing steps:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Clone git project

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{git} \PYG{n}{clone} \PYG{c+c1}{\PYGZsh{}TODO wsadzic tutaj link}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Go into project

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cd} \PYG{c+c1}{\PYGZsh{}TODO project}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxAtStartPar
There is no requirements.txt file, for installing dependencies install a project in editable mode (i.e. setuptools “develop mode”) from a local project path:

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{n}{q} \PYG{o}{\PYGZhy{}}\PYG{n}{e} \PYG{o}{.}
\end{sphinxVerbatim}


\subsection{Create package}
\label{\detokenize{chapters/start/installation:create-package}}
\sphinxAtStartPar
Building package requires setup.cfg and pyproject.toml files located in main tree of pySailingVLM project. If you do not have the latest pip build package do:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{upgrade} \PYG{n}{build}
\end{sphinxVerbatim}

\sphinxAtStartPar
Then:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{build}
\end{sphinxVerbatim}


\subsubsection{Build and install}
\label{\detokenize{chapters/start/installation:build-and-install}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python3} \PYG{o}{\PYGZhy{}}\PYG{n}{m} \PYG{n}{build}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{dist}\PYG{o}{/}\PYG{n}{pySailingVLM}\PYG{o}{\PYGZhy{}}\PYG{n}{VERSION}\PYG{o}{.}\PYG{n}{tar}\PYG{o}{.}\PYG{n}{gz}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Usage}
\label{\detokenize{chapters/usage/usage:usage}}\label{\detokenize{chapters/usage/usage::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
First usage of pySailingVLm will produce numba warining. This behaviour is correct. Warining messages will disappear during second run of program.

\sphinxAtStartPar
Example warning:

\sphinxAtStartPar
/home/user/miniconda3/envs/sv\_build\_test\_2/lib/python3.10/site\sphinxhyphen{}packages/numba/core/lowering.py:107: NumbaDebugInfoWarning: Could not find source for function: <function \_\_numba\_array\_expr\_0x7fbf333f1780 at 0x7fbf33361b40>. Debug line information may be inaccurate.
\end{sphinxadmonition}


\section{Jupyter Notebook}
\label{\detokenize{chapters/usage/usage:jupyter-notebook}}
\sphinxAtStartPar
For Jupyter Notebook examples see Usage subsection.


\section{Command line}
\label{\detokenize{chapters/usage/usage:command-line}}

\subsection{Input file}
\label{\detokenize{chapters/usage/usage:input-file}}
\sphinxAtStartPar
In order to run pySailingVLM from command line you must provide a variable.py file. Example file is shown below. Modify it for your needs.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{time}

\PYG{n}{mgirths} \PYG{o}{=}  \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{7.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{jgirths} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{output\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{basename}\PYG{p}{(}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}file\PYGZus{}\PYGZus{}}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} get name of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}dir}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} get dir of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{results\PYGZus{}example\PYGZus{}jib\PYGZus{}and\PYGZus{}mainsail\PYGZus{}vlm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Y\PYGZhy{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Hh}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Mm}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Ss}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{file\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}fancy\PYGZus{}results}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} name of xlsx excel file}
\PYG{p}{\PYGZcb{}}

\PYG{n}{solver\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}spanwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}  \PYG{l+m+mi}{15}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}chordwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{interpolation\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{spline}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} either \PYGZdq{}spline\PYGZdq{} or \PYGZdq{}linear\PYGZdq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LLT\PYGZus{}twist}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{real\PYGZus{}twist}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} defines how the Lifting Line discretize the sail twist.}
\PYG{p}{\PYGZcb{}}

\PYG{n}{conditions\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{leeway\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{5.}\PYG{p}{,}    \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{heel\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SOG\PYGZus{}yacht}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{4.63}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [m/s] yacht speed \PYGZhy{} speed over ground (leeway is a separate variable)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tws\PYGZus{}ref}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{4.63}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [m/s] true wind speed}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha\PYGZus{}true\PYGZus{}wind\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{50.}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [deg] true wind angle (with reference to course over ground) =\PYGZgt{} Course Wind Angle to the boat track = true wind angle to centerline + Leeway}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}water\PYGZus{}level\PYGZus{}for\PYGZus{}wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] this is an attempt to mimick the deck effect}
    \PYG{c+c1}{\PYGZsh{} by lowering the sheer\PYGZus{}above\PYGZus{}waterline}
    \PYG{c+c1}{\PYGZsh{} while keeping the wind profile as in original geometry}
    \PYG{c+c1}{\PYGZsh{} this shall be negative (H = sail\PYGZus{}ctrl\PYGZus{}point \PYGZhy{} water\PYGZus{}level)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}exp\PYGZus{}coeff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.1428}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [\PYGZhy{}] coefficient to determine the exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}reference\PYGZus{}measurment\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] reference height for exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.225}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} air density [kg/m3]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{exponential}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} allowed: \PYGZsq{}exponential\PYGZsq{} or \PYGZsq{}flat\PYGZsq{} or \PYGZsq{}logarithmic\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roughness}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} for logarithmic profile only }
\PYG{p}{\PYGZcb{}}

\PYG{n}{rig\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{main\PYGZus{}sail\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{12.4}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jib\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.0}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{11.50}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}base}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{3.90}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sheer\PYGZus{}above\PYGZus{}waterline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.2}\PYG{p}{,}\PYG{c+c1}{\PYGZsh{}[m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{boom\PYGZus{}above\PYGZus{}sheer}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.3}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} [m],}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rake\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{92.} \PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} rake angle [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mast\PYGZus{}LOA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.15}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sails\PYGZus{}def}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jib\PYGZus{}and\PYGZus{}main}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} definition of sail set, possible: \PYGZsq{}jib\PYGZsq{} or \PYGZsq{}main\PYGZsq{} or \PYGZsq{}jib\PYGZus{}and\PYGZus{}main\PYGZsq{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} INFO for camber:}
\PYG{c+c1}{\PYGZsh{} First digit describing maximum camber as percentage of the chord.}
\PYG{c+c1}{\PYGZsh{} Second digit describing the distance of maximum camber from the airfoil leading edge in tenths of the chord.}
\PYG{n}{main\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{mgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{4.00}\PYG{p}{,} \PYG{l+m+mf}{3.82}\PYG{p}{,} \PYG{l+m+mf}{3.64}\PYG{p}{,} \PYG{l+m+mf}{3.20}\PYG{p}{,} \PYG{l+m+mf}{2.64}\PYG{p}{,} \PYG{l+m+mf}{2.32}\PYG{p}{,} \PYG{l+m+mf}{2.00}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{12} \PYG{o}{*} \PYG{n}{mgirths} \PYG{o}{+} \PYG{l+m+mi}{5}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
 
\PYG{n}{jib\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{15.} \PYG{o}{*} \PYG{n}{jgirths} \PYG{o}{+} \PYG{l+m+mi}{7}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{jgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{3.80}\PYG{p}{,} \PYG{l+m+mf}{2.98}\PYG{p}{,} \PYG{l+m+mf}{2.15}\PYG{p}{,} \PYG{l+m+mf}{1.33}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} starting from leading edge   }
\PYG{p}{\PYGZcb{}}        

\PYG{c+c1}{\PYGZsh{} REFERENCE CSYS}
\PYG{c+c1}{\PYGZsh{} The origin of the default CSYS is located @ waterline level and aft face of the mast}
\PYG{c+c1}{\PYGZsh{} The positive x\PYGZhy{}coord: towards stern}
\PYG{c+c1}{\PYGZsh{} The positive y\PYGZhy{}coord: towards leeward side}
\PYG{c+c1}{\PYGZsh{} The positive z\PYGZhy{}coord: above the water}
\PYG{c+c1}{\PYGZsh{} To shift the default CSYS, adjust the \PYGZsq{}reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments\PYGZsq{} variable.}
\PYG{c+c1}{\PYGZsh{} Shifted CSYS = original + reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}
\PYG{c+c1}{\PYGZsh{} As a results the moments will be calculated around the new origin.}

\PYG{c+c1}{\PYGZsh{} yaw\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards stern, at which the yawing moment is calculated.}
\PYG{c+c1}{\PYGZsh{} sway\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards leeward side. 0 for symmetric yachts ;)}
\PYG{c+c1}{\PYGZsh{} heeling\PYGZus{}reference [m] \PYGZhy{} distance from the water level,  at which the heeling moment is calculated.}
\PYG{n}{csys\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [yaw\PYGZus{}reference, sway\PYGZus{}reference, heeling\PYGZus{}reference]}
\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} GEOMETRY OF THE KEEL}
\PYG{c+c1}{\PYGZsh{} to estimate heeling moment from keel, does not influence the optimizer.}
\PYG{c+c1}{\PYGZsh{} reminder: the z coord shall be negative (under the water)}
\PYG{n}{keel\PYGZus{}args}\PYG{o}{=}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance\PYGZus{}upright}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] the coordinates for a yacht standing in upright position}
\PYG{p}{\PYGZcb{}}  
\end{sphinxVerbatim}


\subsection{Run script}
\label{\detokenize{chapters/usage/usage:run-script}}
\sphinxAtStartPar
To run script with variables.py located in working directory do:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pySailingVLM}
\end{sphinxVerbatim}

\sphinxAtStartPar
If variables.py is located in different directory, you must sepecify its location by providing additional option for pySailingVLM script:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pySailingVLM} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{dvars} \PYG{n}{path\PYGZus{}to\PYGZus{}foler\PYGZus{}with\PYGZus{}variables}\PYG{o}{.}\PYG{n}{py}
\end{sphinxVerbatim}

\sphinxAtStartPar
More information is available inside script help:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pySailingVLM} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{help}
\end{sphinxVerbatim}


\subsection{Output}
\label{\detokenize{chapters/usage/usage:output}}
\sphinxAtStartPar
pySailingVLM produces output files: data in xlsx file, matplotlib figures and pressure coefficient colormap in html extention (interactive plot). It is saved in the location specified in varaibles.py.

\sphinxstepscope


\section{Cambered jib and main example}
\label{\detokenize{chapters/examples/sailingvlm_example:cambered-jib-and-main-example}}\label{\detokenize{chapters/examples/sailingvlm_example::doc}}
\sphinxAtStartPar
In cell below insert your initial parameters. If some of them are not required for your model, simply pass 0 value (for numbers).
Some parameters are necessary only for specific cases like roughness (used by package when logarithmic profile is set) and they are omitted during computation.



\sphinxAtStartPar
More information can be found in code comments below.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} varaibles.py for jupyter}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{time}

\PYG{n}{mgirths} \PYG{o}{=}  \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{7.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{jgirths} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{output\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}case\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} get name of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}dir}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} get dir of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{results\PYGZus{}example\PYGZus{}jib\PYGZus{}and\PYGZus{}mainsail\PYGZus{}vlm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Y\PYGZhy{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Hh}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Mm}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Ss}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{file\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}fancy\PYGZus{}results}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} name of xlsx excel file}
\PYG{p}{\PYGZcb{}}

\PYG{n}{solver\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}spanwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}  \PYG{l+m+mi}{10}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}chordwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{interpolation\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{spline}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} either \PYGZdq{}spline\PYGZdq{} or \PYGZdq{}linear\PYGZdq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LLT\PYGZus{}twist}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{real\PYGZus{}twist}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} defines how the Lifting Line discretize the sail twist.}
\PYG{p}{\PYGZcb{}}

\PYG{n}{conditions\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{leeway\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{5.}\PYG{p}{,}    \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{heel\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SOG\PYGZus{}yacht}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{4.63}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [m/s] yacht speed \PYGZhy{} speed over ground (leeway is a separate variable)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tws\PYGZus{}ref}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{4.63}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [m/s] true wind speed}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha\PYGZus{}true\PYGZus{}wind\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{50.}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [deg] true wind angle (with reference to course over ground) =\PYGZgt{} Course Wind Angle to the boat track = true wind angle to centerline + Leeway}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}water\PYGZus{}level\PYGZus{}for\PYGZus{}wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] this is an attempt to mimick the deck effect}
    \PYG{c+c1}{\PYGZsh{} by lowering the sheer\PYGZus{}above\PYGZus{}waterline}
    \PYG{c+c1}{\PYGZsh{} while keeping the wind profile as in original geometry}
    \PYG{c+c1}{\PYGZsh{} this shall be negative (H = sail\PYGZus{}ctrl\PYGZus{}point \PYGZhy{} water\PYGZus{}level)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}exp\PYGZus{}coeff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.1428}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [\PYGZhy{}] coefficient to determine the exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}reference\PYGZus{}measurment\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] reference height for exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.225}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} air density [kg/m3]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{exponential}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} allowed: \PYGZsq{}exponential\PYGZsq{} or \PYGZsq{}flat\PYGZsq{} or \PYGZsq{}logarithmic\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roughness}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} for logarithmic profile only }
\PYG{p}{\PYGZcb{}}

\PYG{n}{rig\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{main\PYGZus{}sail\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{12.4}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jib\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.0}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{11.50}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}base}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{3.90}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sheer\PYGZus{}above\PYGZus{}waterline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.2}\PYG{p}{,}\PYG{c+c1}{\PYGZsh{}[m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{boom\PYGZus{}above\PYGZus{}sheer}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.3}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} [m],}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rake\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{92.} \PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} rake angle [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mast\PYGZus{}LOA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.15}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sails\PYGZus{}def}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jib\PYGZus{}and\PYGZus{}main}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} definition of sail set, possible: \PYGZsq{}jib\PYGZsq{} or \PYGZsq{}main\PYGZsq{} or \PYGZsq{}jib\PYGZus{}and\PYGZus{}main\PYGZsq{}}
\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} INFO for camber:}
\PYG{c+c1}{\PYGZsh{} First digit describing maximum camber as percentage of the chord.}
\PYG{c+c1}{\PYGZsh{} Second digit describing the distance of maximum camber from the airfoil leading edge in tenths of the chord.}
\PYG{n}{main\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{mgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{4.00}\PYG{p}{,} \PYG{l+m+mf}{3.82}\PYG{p}{,} \PYG{l+m+mf}{3.64}\PYG{p}{,} \PYG{l+m+mf}{3.20}\PYG{p}{,} \PYG{l+m+mf}{2.64}\PYG{p}{,} \PYG{l+m+mf}{2.32}\PYG{p}{,} \PYG{l+m+mf}{2.00}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{12} \PYG{o}{*} \PYG{n}{mgirths} \PYG{o}{+} \PYG{l+m+mi}{5}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
 
\PYG{n}{jib\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{15.} \PYG{o}{*} \PYG{n}{jgirths} \PYG{o}{+} \PYG{l+m+mi}{7}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{jgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{3.80}\PYG{p}{,} \PYG{l+m+mf}{2.98}\PYG{p}{,} \PYG{l+m+mf}{2.15}\PYG{p}{,} \PYG{l+m+mf}{1.33}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} starting from leading edge   }
\PYG{p}{\PYGZcb{}}        

\PYG{c+c1}{\PYGZsh{} REFERENCE CSYS}
\PYG{c+c1}{\PYGZsh{} The origin of the default CSYS is located @ waterline level and aft face of the mast}
\PYG{c+c1}{\PYGZsh{} The positive x\PYGZhy{}coord: towards stern}
\PYG{c+c1}{\PYGZsh{} The positive y\PYGZhy{}coord: towards leeward side}
\PYG{c+c1}{\PYGZsh{} The positive z\PYGZhy{}coord: above the water}
\PYG{c+c1}{\PYGZsh{} To shift the default CSYS, adjust the \PYGZsq{}reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments\PYGZsq{} variable.}
\PYG{c+c1}{\PYGZsh{} Shifted CSYS = original + reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}
\PYG{c+c1}{\PYGZsh{} As a results the moments will be calculated around the new origin.}

\PYG{c+c1}{\PYGZsh{} yaw\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards stern, at which the yawing moment is calculated.}
\PYG{c+c1}{\PYGZsh{} sway\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards leeward side. 0 for symmetric yachts ;)}
\PYG{c+c1}{\PYGZsh{} heeling\PYGZus{}reference [m] \PYGZhy{} distance from the water level,  at which the heeling moment is calculated.}
\PYG{n}{csys\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [yaw\PYGZus{}reference, sway\PYGZus{}reference, heeling\PYGZus{}reference]}
\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} GEOMETRY OF THE KEEL}
\PYG{c+c1}{\PYGZsh{} to estimate heeling moment from keel, does not influence the optimizer.}
\PYG{c+c1}{\PYGZsh{} reminder: the z coord shall be negative (under the water)}
\PYG{n}{keel\PYGZus{}args}\PYG{o}{=}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance\PYGZus{}upright}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] the coordinates for a yacht standing in upright position}
\PYG{p}{\PYGZcb{}}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}




\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{shutil}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{rotations}\PYG{n+nn}{.}\PYG{n+nn}{csys\PYGZus{}transformations} \PYG{k+kn}{import} \PYG{n}{CSYS\PYGZus{}transformations}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{yacht\PYGZus{}geometry}\PYG{n+nn}{.}\PYG{n+nn}{hull\PYGZus{}geometry} \PYG{k+kn}{import} \PYG{n}{HullGeometry}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{results}\PYG{n+nn}{.}\PYG{n+nn}{save\PYGZus{}utils} \PYG{k+kn}{import} \PYG{n}{save\PYGZus{}results\PYGZus{}to\PYGZus{}file}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{panels\PYGZus{}plotter} \PYG{k+kn}{import} \PYG{n}{display\PYGZus{}panels\PYGZus{}xyz\PYGZus{}and\PYGZus{}winds}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{results}\PYG{n+nn}{.}\PYG{n+nn}{inviscid\PYGZus{}flow} \PYG{k+kn}{import} \PYG{n}{InviscidFlowResults}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{vlm} \PYG{k+kn}{import} \PYG{n}{Vlm}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{runner}\PYG{n+nn}{.}\PYG{n+nn}{sail} \PYG{k+kn}{import} \PYG{n}{Wind}\PYG{p}{,} \PYG{n}{Sail}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{runner}\PYG{n+nn}{.}\PYG{n+nn}{container} \PYG{k+kn}{import} \PYG{n}{Output}\PYG{p}{,} \PYG{n}{Rig}\PYG{p}{,} \PYG{n}{Conditions}\PYG{p}{,} \PYG{n}{Solver}\PYG{p}{,} \PYG{n}{MainSail}\PYG{p}{,} \PYG{n}{JibSail}\PYG{p}{,} \PYG{n}{Csys}\PYG{p}{,} \PYG{n}{Keel}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{panels\PYGZus{}plotter} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}cp}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{out} \PYG{o}{=} \PYG{n}{Output}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{output\PYGZus{}args}\PYG{p}{)}
\PYG{n}{conditions} \PYG{o}{=} \PYG{n}{Conditions}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{conditions\PYGZus{}args}\PYG{p}{)}
\PYG{n}{solver} \PYG{o}{=} \PYG{n}{Solver}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{solver\PYGZus{}args}\PYG{p}{)}
\PYG{n}{main} \PYG{o}{=} \PYG{n}{MainSail}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{main\PYGZus{}sail\PYGZus{}args}\PYG{p}{)}
\PYG{n}{jib} \PYG{o}{=} \PYG{n}{JibSail}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{jib\PYGZus{}sail\PYGZus{}args}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} j2 = JibSail(centerline\PYGZus{}twist\PYGZus{}deg= 15. * jgirths + 7, girths= jgirths) set centerline\PYGZus{}twist\PYGZus{}deg and girths, rest is default}

\PYG{n}{csys} \PYG{o}{=} \PYG{n}{Csys}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{csys\PYGZus{}args}\PYG{p}{)}
\PYG{n}{keel} \PYG{o}{=} \PYG{n}{Keel}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{keel\PYGZus{}args}\PYG{p}{)}
\PYG{n}{rig} \PYG{o}{=} \PYG{n}{Rig}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{rig\PYGZus{}args}\PYG{p}{)}

\PYG{n}{csys\PYGZus{}transformations} \PYG{o}{=} \PYG{n}{CSYS\PYGZus{}transformations}\PYG{p}{(}
    \PYG{n}{conditions}\PYG{o}{.}\PYG{n}{heel\PYGZus{}deg}\PYG{p}{,} \PYG{n}{conditions}\PYG{o}{.}\PYG{n}{leeway\PYGZus{}deg}\PYG{p}{,}
    \PYG{n}{v\PYGZus{}from\PYGZus{}original\PYGZus{}xyz\PYGZus{}2\PYGZus{}reference\PYGZus{}csys\PYGZus{}xyz}\PYG{o}{=}\PYG{n}{csys}\PYG{o}{.}\PYG{n}{reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}\PYG{p}{)}


\PYG{n}{w} \PYG{o}{=} \PYG{n}{Wind}\PYG{p}{(}\PYG{n}{conditions}\PYG{p}{)}
\PYG{n}{s} \PYG{o}{=} \PYG{n}{Sail}\PYG{p}{(}\PYG{n}{solver}\PYG{p}{,} \PYG{n}{rig}\PYG{p}{,} \PYG{n}{main}\PYG{p}{,} \PYG{n}{jib}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{)}
\PYG{n}{sail\PYGZus{}set} \PYG{o}{=} \PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}
\PYG{n}{hull} \PYG{o}{=} \PYG{n}{HullGeometry}\PYG{p}{(}\PYG{n}{rig}\PYG{o}{.}\PYG{n}{sheer\PYGZus{}above\PYGZus{}waterline}\PYG{p}{,} \PYG{n}{rig}\PYG{o}{.}\PYG{n}{foretriangle\PYGZus{}base}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{keel}\PYG{o}{.}\PYG{n}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance\PYGZus{}upright}\PYG{p}{)}
\PYG{n}{myvlm} \PYG{o}{=} \PYG{n}{Vlm}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{panels}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{.}\PYG{n}{n\PYGZus{}chordwise}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{.}\PYG{n}{n\PYGZus{}spanwise}\PYG{p}{,} \PYG{n}{conditions}\PYG{o}{.}\PYG{n}{rho}\PYG{p}{,} \PYG{n}{w}\PYG{o}{.}\PYG{n}{profile}\PYG{p}{,} \PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{trailing\PYGZus{}edge\PYGZus{}info}\PYG{p}{,} \PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{leading\PYGZus{}edge\PYGZus{}info}\PYG{p}{)}

\PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results} \PYG{o}{=} \PYG{n}{InviscidFlowResults}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{myvlm}\PYG{p}{)}
\PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{o}{.}\PYG{n}{estimate\PYGZus{}heeling\PYGZus{}moment\PYGZus{}from\PYGZus{}keel}\PYG{p}{(}\PYG{n}{hull}\PYG{o}{.}\PYG{n}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Cell below displays computations and saves integrals to output file.



\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} widget
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Preparing visualization.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}   
\PYG{n}{display\PYGZus{}panels\PYGZus{}xyz\PYGZus{}and\PYGZus{}winds}\PYG{p}{(}\PYG{n}{myvlm}\PYG{p}{,} \PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{p}{,} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{inlet\PYGZus{}conditions}\PYG{p}{,} \PYG{n}{hull}\PYG{p}{,} \PYG{n}{show\PYGZus{}plot}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} add show\PYGZus{}apparent\PYGZus{}induced\PYGZus{}wind=True for apparent + induced wind }
\PYG{n}{df\PYGZus{}components}\PYG{p}{,} \PYG{n}{df\PYGZus{}integrals}\PYG{p}{,} \PYG{n}{df\PYGZus{}inlet\PYGZus{}IC} \PYG{o}{=} \PYG{n}{save\PYGZus{}results\PYGZus{}to\PYGZus{}file}\PYG{p}{(}\PYG{n}{myvlm}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{p}{,} \PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{name}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{file\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Preparing visualization.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{8438bab6410e37d2b2944336774f46ad0522318990d40560ce0988ff54e7c442}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Lets see our integrals :)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Notice:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The forces [N] and moments [Nm] are without profile drag.}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The the \PYGZus{}COG\PYGZus{} CSYS is aligned in the direction of the yacht movement (course over ground).}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The the \PYGZus{}COW\PYGZus{} CSYS is aligned along the centerline of the yacht (course over water).}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{Number of panels (sail s.sail\PYGZus{}set with mirror): }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{panels}\PYG{o}{.}\PYG{n}{shape}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{df\PYGZus{}integrals}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Notice:
	The forces [N] and moments [Nm] are without profile drag.
	The the \PYGZus{}COG\PYGZus{} CSYS is aligned in the direction of the yacht movement (course over ground).
	The the \PYGZus{}COW\PYGZus{} CSYS is aligned along the centerline of the yacht (course over water).
	Number of panels (sail s.sail\PYGZus{}set with mirror): (200, 4, 3)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                               Quantity         Value
0                     F\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.x   \PYGZhy{}279.764768
1                     F\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.y    678.500639
2                     F\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.z    \PYGZhy{}50.156361
3               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.x   \PYGZhy{}354.636548
4               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.y   1057.983557
5               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.z   \PYGZhy{}202.903407
6                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.x   \PYGZhy{}634.401316
7                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.y   1736.484196
8                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.z   \PYGZhy{}253.059767
9                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.x   \PYGZhy{}783.331797
10                  F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.y   1674.584632
11                  F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z   \PYGZhy{}253.059767
12                    M\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.x  \PYGZhy{}3579.994204
13                    M\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.y  \PYGZhy{}1661.671677
14                    M\PYGZus{}jib\PYGZus{}total\PYGZus{}COG.z   \PYGZhy{}798.223020
15                   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.x  \PYGZhy{}1753.879249
16                   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.y   \PYGZhy{}628.593251
17                   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.z     83.462722
18            M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.x (heel)  \PYGZhy{}1692.419697
19           M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.y (pitch)   \PYGZhy{}779.061913
20   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign)    \PYGZhy{}83.462722
21             M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.z (yaw)     83.462722
22              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.x  \PYGZhy{}9443.296080
23              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.y  \PYGZhy{}2994.708741
24              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.z   2404.207819
25                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.x \PYGZhy{}13023.290285
26                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.y  \PYGZhy{}4656.380418
27                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.z   1605.984799
28           M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.x (heel) \PYGZhy{}12567.902440
29          M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.y (pitch)  \PYGZhy{}5773.716022
30  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign)  \PYGZhy{}1605.984799
31            M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z (yaw)   1605.984799
32                        M\PYGZus{}total\PYGZus{}COG.x \PYGZhy{}14777.169534
33                        M\PYGZus{}total\PYGZus{}COG.y  \PYGZhy{}5284.973669
34                        M\PYGZus{}total\PYGZus{}COG.z   1689.447521
35                 M\PYGZus{}total\PYGZus{}COW.x (heel) \PYGZhy{}14260.322137
36                M\PYGZus{}total\PYGZus{}COW.y (pitch)  \PYGZhy{}6552.777935
37        M\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign)  \PYGZhy{}1689.447521
38                  M\PYGZus{}total\PYGZus{}COW.z (yaw)   1689.447521
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Compute aerodynamic parameters:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sails\PYGZus{}Cxyz} \PYG{o}{=} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{get\PYGZus{}Cxyz}\PYG{p}{(}\PYG{n}{w}\PYG{p}{,} \PYG{l+m+mf}{1.0}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cxyz for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{rig}\PYG{o}{.}\PYG{n}{sails\PYGZus{}def}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{idx}\PYG{p}{,} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{sails\PYGZus{}Cxyz}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{C[}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{idx}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{]: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{c}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Cxyz for jib\PYGZus{}and\PYGZus{}main
C[0]: [\PYGZhy{}2.02304539  4.90639904 \PYGZhy{}0.36269254]
C[1]: [\PYGZhy{}1.33774067  3.99086794 \PYGZhy{}0.76538118]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Make model plot in 2D colored by pressure coefficients:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{panels\PYGZus{}plotter} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}cp}
\PYG{n}{plot\PYGZus{}cp}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{zero\PYGZus{}mesh}\PYG{p}{,} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{p\PYGZus{}coeffs}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Thats all. Experiment and play with this code on your own.

\sphinxstepscope


\section{Sweep cambered main sail}
\label{\detokenize{chapters/examples/sweep_example:sweep-cambered-main-sail}}\label{\detokenize{chapters/examples/sweep_example::doc}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} varaibles.py for jupyter}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{time}

\PYG{n}{half\PYGZus{}wing\PYGZus{}span} \PYG{o}{=} \PYG{l+m+mi}{8}
\PYG{n}{sweep\PYGZus{}angle\PYGZus{}deg} \PYG{o}{=} \PYG{l+m+mf}{5.}
\PYG{n}{chord\PYGZus{}length} \PYG{o}{=} \PYG{l+m+mi}{4}
\PYG{n}{AoA\PYGZus{}deg} \PYG{o}{=} \PYG{l+m+mf}{8.}
\PYG{n}{mgirths} \PYG{o}{=}  \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{7.}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{mchords} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{chord\PYGZus{}length}\PYG{p}{]}\PYG{o}{*} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{mgirths}\PYG{p}{)}\PYG{p}{)}

   
\PYG{n}{output\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}case\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} get name of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{case\PYGZus{}dir}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} get dir of the current file}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{results\PYGZus{}example\PYGZus{}jib\PYGZus{}and\PYGZus{}mainsail\PYGZus{}vlm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Y\PYGZhy{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Hh}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Mm}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Ss}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{file\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}fancy\PYGZus{}results}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} name of xlsx excel file}
\PYG{p}{\PYGZcb{}}

\PYG{n}{solver\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}spanwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}  \PYG{l+m+mi}{5}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}chordwise}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} No of control points (above the water) per sail, recommended: 50}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{interpolation\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{linear}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} either \PYGZdq{}spline\PYGZdq{} or \PYGZdq{}linear\PYGZdq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LLT\PYGZus{}twist}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{real\PYGZus{}twist}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} defines how the Lifting Line discretize the sail twist.}
\PYG{p}{\PYGZcb{}}

\PYG{n}{conditions\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{leeway\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.}\PYG{p}{,}    \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{heel\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SOG\PYGZus{}yacht}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [m/s] yacht speed \PYGZhy{} speed over ground (leeway is a separate variable)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tws\PYGZus{}ref}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.0}\PYG{p}{,}     \PYG{c+c1}{\PYGZsh{} [m/s] true wind speed}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{alpha\PYGZus{}true\PYGZus{}wind\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{AoA\PYGZus{}deg}\PYG{p}{,}   \PYG{c+c1}{\PYGZsh{} [deg] true wind angle (with reference to course over ground) =\PYGZgt{} Course Wind Angle to the boat track = true wind angle to centerline + Leeway}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}water\PYGZus{}level\PYGZus{}for\PYGZus{}wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] this is an attempt to mimick the deck effect}
    \PYG{c+c1}{\PYGZsh{} by lowering the sheer\PYGZus{}above\PYGZus{}waterline}
    \PYG{c+c1}{\PYGZsh{} while keeping the wind profile as in original geometry}
    \PYG{c+c1}{\PYGZsh{} this shall be negative (H = sail\PYGZus{}ctrl\PYGZus{}point \PYGZhy{} water\PYGZus{}level)}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}exp\PYGZus{}coeff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [\PYGZhy{}] coefficient to determine the exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}reference\PYGZus{}measurment\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] reference height for exponential wind profile}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} air density [kg/m3]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wind\PYGZus{}profile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{flat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} allowed: \PYGZsq{}exponential\PYGZsq{} or \PYGZsq{}flat\PYGZsq{} or \PYGZsq{}logarithmic\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roughness}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} for logarithmic profile only }
\PYG{p}{\PYGZcb{}}


\PYG{n}{rig\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{main\PYGZus{}sail\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{half\PYGZus{}wing\PYGZus{}span} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{deg2rad}\PYG{p}{(}\PYG{n}{sweep\PYGZus{}angle\PYGZus{}deg}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jib\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{10.0}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{11.50}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{foretriangle\PYGZus{}base}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{3.90}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sheer\PYGZus{}above\PYGZus{}waterline}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.2}\PYG{p}{,}\PYG{c+c1}{\PYGZsh{}[m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{boom\PYGZus{}above\PYGZus{}sheer}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.3}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} [m],}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rake\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{90.} \PYG{o}{+} \PYG{n}{sweep\PYGZus{}angle\PYGZus{}deg}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} rake angle [deg]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mast\PYGZus{}LOA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m]}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sails\PYGZus{}def}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{main}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} definition of sail set, possible: \PYGZsq{}jib\PYGZsq{} or \PYGZsq{}main\PYGZsq{} or \PYGZsq{}jib\PYGZus{}and\PYGZus{}main\PYGZsq{}}
\PYG{p}{\PYGZcb{}}


\PYG{c+c1}{\PYGZsh{} INFO for camber:}
\PYG{c+c1}{\PYGZsh{} First digit describing maximum camber as percentage of the chord.}
\PYG{c+c1}{\PYGZsh{} Second digit describing the distance of maximum camber from the airfoil leading edge in tenths of the chord.}
\PYG{n}{main\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{n}{mgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{mchords}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{*}\PYG{n}{mgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}
 

\PYG{n}{jgirths} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mf}{3.}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{1.00}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{jib\PYGZus{}sail\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{centerline\PYGZus{}twist\PYGZus{}deg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{p}{)}  \PYG{o}{+} \PYG{l+m+mi}{0}\PYG{o}{*}\PYG{l+m+mf}{15.} \PYG{o}{*} \PYG{n}{jgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{girths}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{jgirths}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{chords}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{3.80}\PYG{p}{,} \PYG{l+m+mf}{2.98}\PYG{p}{,} \PYG{l+m+mf}{2.15}\PYG{p}{,} \PYG{l+m+mf}{1.33}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{camber\PYGZus{}distance\PYGZus{}from\PYGZus{}luff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{c+c1}{\PYGZsh{} starting from leading edge   }
\PYG{p}{\PYGZcb{}}        

\PYG{c+c1}{\PYGZsh{} REFERENCE CSYS}
\PYG{c+c1}{\PYGZsh{} The origin of the default CSYS is located @ waterline level and aft face of the mast}
\PYG{c+c1}{\PYGZsh{} The positive x\PYGZhy{}coord: towards stern}
\PYG{c+c1}{\PYGZsh{} The positive y\PYGZhy{}coord: towards leeward side}
\PYG{c+c1}{\PYGZsh{} The positive z\PYGZhy{}coord: above the water}
\PYG{c+c1}{\PYGZsh{} To shift the default CSYS, adjust the \PYGZsq{}reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments\PYGZsq{} variable.}
\PYG{c+c1}{\PYGZsh{} Shifted CSYS = original + reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}
\PYG{c+c1}{\PYGZsh{} As a results the moments will be calculated around the new origin.}

\PYG{c+c1}{\PYGZsh{} yaw\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards stern, at which the yawing moment is calculated.}
\PYG{c+c1}{\PYGZsh{} sway\PYGZus{}reference [m] \PYGZhy{} distance from the aft of the mast towards leeward side. 0 for symmetric yachts ;)}
\PYG{c+c1}{\PYGZsh{} heeling\PYGZus{}reference [m] \PYGZhy{} distance from the water level,  at which the heeling moment is calculated.}
\PYG{n}{csys\PYGZus{}args} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [yaw\PYGZus{}reference, sway\PYGZus{}reference, heeling\PYGZus{}reference]}
\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} GEOMETRY OF THE KEEL}
\PYG{c+c1}{\PYGZsh{} to estimate heeling moment from keel, does not influence the optimizer.}
\PYG{c+c1}{\PYGZsh{} reminder: the z coord shall be negative (under the water)}
\PYG{n}{keel\PYGZus{}args}\PYG{o}{=}\PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance\PYGZus{}upright}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} [m] the coordinates for a yacht standing in upright position}
\PYG{p}{\PYGZcb{}}  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}




\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{shutil}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{rotations}\PYG{n+nn}{.}\PYG{n+nn}{csys\PYGZus{}transformations} \PYG{k+kn}{import} \PYG{n}{CSYS\PYGZus{}transformations}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{yacht\PYGZus{}geometry}\PYG{n+nn}{.}\PYG{n+nn}{hull\PYGZus{}geometry} \PYG{k+kn}{import} \PYG{n}{HullGeometry}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{results}\PYG{n+nn}{.}\PYG{n+nn}{save\PYGZus{}utils} \PYG{k+kn}{import} \PYG{n}{save\PYGZus{}results\PYGZus{}to\PYGZus{}file}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{panels\PYGZus{}plotter} \PYG{k+kn}{import} \PYG{n}{display\PYGZus{}panels\PYGZus{}xyz\PYGZus{}and\PYGZus{}winds}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{results}\PYG{n+nn}{.}\PYG{n+nn}{inviscid\PYGZus{}flow} \PYG{k+kn}{import} \PYG{n}{InviscidFlowResults}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{vlm} \PYG{k+kn}{import} \PYG{n}{Vlm}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{runner}\PYG{n+nn}{.}\PYG{n+nn}{sail} \PYG{k+kn}{import} \PYG{n}{Wind}\PYG{p}{,} \PYG{n}{Sail}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{runner}\PYG{n+nn}{.}\PYG{n+nn}{container} \PYG{k+kn}{import} \PYG{n}{Output}\PYG{p}{,} \PYG{n}{Rig}\PYG{p}{,} \PYG{n}{Conditions}\PYG{p}{,} \PYG{n}{Solver}\PYG{p}{,} \PYG{n}{MainSail}\PYG{p}{,} \PYG{n}{JibSail}\PYG{p}{,} \PYG{n}{Csys}\PYG{p}{,} \PYG{n}{Keel}

\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{panels\PYGZus{}plotter} \PYG{k+kn}{import} \PYG{n}{plot\PYGZus{}cp}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{pySailingVLM}\PYG{n+nn}{.}\PYG{n+nn}{solver}\PYG{n+nn}{.}\PYG{n+nn}{coefs} \PYG{k+kn}{import} \PYG{n}{get\PYGZus{}vlm\PYGZus{}Cxyz}

\PYG{n}{C\PYGZus{}results} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
\PYG{n}{a\PYGZus{}vlm\PYGZus{}results} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{n}{out} \PYG{o}{=} \PYG{n}{Output}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{output\PYGZus{}args}\PYG{p}{)}
\PYG{n}{conditions} \PYG{o}{=} \PYG{n}{Conditions}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{conditions\PYGZus{}args}\PYG{p}{)}
\PYG{n}{solver} \PYG{o}{=} \PYG{n}{Solver}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{solver\PYGZus{}args}\PYG{p}{)}
\PYG{n}{main} \PYG{o}{=} \PYG{n}{MainSail}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{main\PYGZus{}sail\PYGZus{}args}\PYG{p}{)}
\PYG{n}{jib} \PYG{o}{=} \PYG{n}{JibSail}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{jib\PYGZus{}sail\PYGZus{}args}\PYG{p}{)}
\PYG{n}{csys} \PYG{o}{=} \PYG{n}{Csys}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{csys\PYGZus{}args}\PYG{p}{)}
\PYG{n}{keel} \PYG{o}{=} \PYG{n}{Keel}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{keel\PYGZus{}args}\PYG{p}{)}
\PYG{n}{rig} \PYG{o}{=} \PYG{n}{Rig}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{rig\PYGZus{}args}\PYG{p}{)}
\PYG{n}{csys\PYGZus{}transformations} \PYG{o}{=} \PYG{n}{CSYS\PYGZus{}transformations}\PYG{p}{(}\PYG{n}{conditions}\PYG{o}{.}\PYG{n}{heel\PYGZus{}deg}\PYG{p}{,} \PYG{n}{conditions}\PYG{o}{.}\PYG{n}{leeway\PYGZus{}deg}\PYG{p}{,} \PYG{n}{v\PYGZus{}from\PYGZus{}original\PYGZus{}xyz\PYGZus{}2\PYGZus{}reference\PYGZus{}csys\PYGZus{}xyz}\PYG{o}{=}\PYG{n}{csys}\PYG{o}{.}\PYG{n}{reference\PYGZus{}level\PYGZus{}for\PYGZus{}moments}\PYG{p}{)}


\PYG{n}{w} \PYG{o}{=} \PYG{n}{Wind}\PYG{p}{(}\PYG{n}{conditions}\PYG{p}{)}
\PYG{n}{s} \PYG{o}{=} \PYG{n}{Sail}\PYG{p}{(}\PYG{n}{solver}\PYG{p}{,} \PYG{n}{rig}\PYG{p}{,} \PYG{n}{main}\PYG{p}{,} \PYG{n}{jib}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{)}
\PYG{n}{sail\PYGZus{}set} \PYG{o}{=} \PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}
\PYG{n}{myvlm} \PYG{o}{=} \PYG{n}{Vlm}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{panels}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{.}\PYG{n}{n\PYGZus{}chordwise}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{.}\PYG{n}{n\PYGZus{}spanwise}\PYG{p}{,} \PYG{n}{conditions}\PYG{o}{.}\PYG{n}{rho}\PYG{p}{,} \PYG{n}{w}\PYG{o}{.}\PYG{n}{profile}\PYG{p}{,} \PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{trailing\PYGZus{}edge\PYGZus{}info}\PYG{p}{,} \PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{leading\PYGZus{}edge\PYGZus{}info}\PYG{p}{)}

\PYG{n}{height} \PYG{o}{=} \PYG{l+m+mf}{1.0}
\PYG{n}{sails\PYGZus{}Cxyz} \PYG{o}{=} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{get\PYGZus{}Cxyz}\PYG{p}{(}\PYG{n}{w}\PYG{p}{,} \PYG{n}{height}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} enumerate through sails}
\PYG{c+c1}{\PYGZsh{} in this example we have only main}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cxyz for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{rig}\PYG{o}{.}\PYG{n}{sails\PYGZus{}def}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{idx}\PYG{p}{,} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{sails\PYGZus{}Cxyz}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{C[}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{idx}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{]: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{c}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    
\PYG{n}{hull} \PYG{o}{=} \PYG{n}{HullGeometry}\PYG{p}{(}\PYG{n}{rig}\PYG{o}{.}\PYG{n}{sheer\PYGZus{}above\PYGZus{}waterline}\PYG{p}{,} \PYG{n}{rig}\PYG{o}{.}\PYG{n}{foretriangle\PYGZus{}base}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{keel}\PYG{o}{.}\PYG{n}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance\PYGZus{}upright}\PYG{p}{)}
\PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results} \PYG{o}{=} \PYG{n}{InviscidFlowResults}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{myvlm}\PYG{p}{)}
\PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{o}{.}\PYG{n}{estimate\PYGZus{}heeling\PYGZus{}moment\PYGZus{}from\PYGZus{}keel}\PYG{p}{(}\PYG{n}{hull}\PYG{o}{.}\PYG{n}{center\PYGZus{}of\PYGZus{}lateral\PYGZus{}resistance}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Cxyz for main
C[0]: [ 0.06028863  2.83686792 \PYGZhy{}0.00527457]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{matplotlib} widget
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Preparing visualization.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}   
\PYG{n}{display\PYGZus{}panels\PYGZus{}xyz\PYGZus{}and\PYGZus{}winds}\PYG{p}{(}\PYG{n}{myvlm}\PYG{p}{,} \PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{p}{,} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{inlet\PYGZus{}conditions}\PYG{p}{,} \PYG{n}{hull}\PYG{p}{,} \PYG{n}{show\PYGZus{}plot}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{show\PYGZus{}apparent\PYGZus{}induced\PYGZus{}wind}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} add show\PYGZus{}apparent\PYGZus{}induced\PYGZus{}wind=True for apparent + induced wind }
\PYG{n}{df\PYGZus{}components}\PYG{p}{,} \PYG{n}{df\PYGZus{}integrals}\PYG{p}{,} \PYG{n}{df\PYGZus{}inlet\PYGZus{}IC} \PYG{o}{=} \PYG{n}{save\PYGZus{}results\PYGZus{}to\PYGZus{}file}\PYG{p}{(}\PYG{n}{myvlm}\PYG{p}{,} \PYG{n}{csys\PYGZus{}transformations}\PYG{p}{,} \PYG{n}{inviscid\PYGZus{}flow\PYGZus{}results}\PYG{p}{,} \PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{name}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{file\PYGZus{}name}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Preparing visualization.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{b9c88075c9161e3b4293a1c7f53f1ec147c942042642a20d172dabad6b2fb6d3}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Notice:}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The forces [N] and moments [Nm] are without profile drag.}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The the \PYGZus{}COG\PYGZus{} CSYS is aligned in the direction of the yacht movement (course over ground).}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{The the \PYGZus{}COW\PYGZus{} CSYS is aligned along the centerline of the yacht (course over water).}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
  \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{Number of panels (sail s.sail\PYGZus{}set with mirror): }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{s}\PYG{o}{.}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{panels}\PYG{o}{.}\PYG{n}{shape}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{df\PYGZus{}integrals}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Notice:
	The forces [N] and moments [Nm] are without profile drag.
	The the \PYGZus{}COG\PYGZus{} CSYS is aligned in the direction of the yacht movement (course over ground).
	The the \PYGZus{}COW\PYGZus{} CSYS is aligned along the centerline of the yacht (course over water).
	Number of panels (sail s.sail\PYGZus{}set with mirror): (50, 4, 3)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                               Quantity       Value
0               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.x    0.988981
1               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.y   46.536280
2               F\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.z   \PYGZhy{}0.086525
3                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.x    0.988981
4                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.y   46.536280
5                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.z   \PYGZhy{}0.086525
6                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.x    0.988981
7                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.y   46.536280
8                   F\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z   \PYGZhy{}0.086525
9                    M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.x  \PYGZhy{}46.536280
10                   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.y    0.988981
11                   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COG.z    0.000000
12            M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.x (heel)  \PYGZhy{}46.536280
13           M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.y (pitch)    0.988981
14   M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign)   \PYGZhy{}0.000000
15             M\PYGZus{}keel\PYGZus{}total\PYGZus{}COW.z (yaw)    0.000000
16              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.x \PYGZhy{}302.514742
17              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.y    6.902970
18              M\PYGZus{}main\PYGZus{}sail\PYGZus{}total\PYGZus{}COG.z  137.446498
19                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.x \PYGZhy{}302.514742
20                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.y    6.902970
21                  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COG.z  137.446498
22           M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.x (heel) \PYGZhy{}302.514742
23          M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.y (pitch)    6.902970
24  M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign) \PYGZhy{}137.446498
25            M\PYGZus{}sails\PYGZus{}total\PYGZus{}COW.z (yaw)  137.446498
26                        M\PYGZus{}total\PYGZus{}COG.x \PYGZhy{}349.051021
27                        M\PYGZus{}total\PYGZus{}COG.y    7.891951
28                        M\PYGZus{}total\PYGZus{}COG.z  137.446498
29                 M\PYGZus{}total\PYGZus{}COW.x (heel) \PYGZhy{}349.051021
30                M\PYGZus{}total\PYGZus{}COW.y (pitch)    7.891951
31        M\PYGZus{}total\PYGZus{}COW.z (yaw \PYGZhy{} JG sign) \PYGZhy{}137.446498
32                  M\PYGZus{}total\PYGZus{}COW.z (yaw)  137.446498
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}cp}\PYG{p}{(}\PYG{n}{sail\PYGZus{}set}\PYG{o}{.}\PYG{n}{zero\PYGZus{}mesh}\PYG{p}{,} \PYG{n}{myvlm}\PYG{o}{.}\PYG{n}{p\PYGZus{}coeffs}\PYG{p}{,} \PYG{n}{out}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxstepscope


\chapter{Validation}
\label{\detokenize{chapters/validation/validation:validation}}\label{\detokenize{chapters/validation/validation::doc}}
\sphinxAtStartPar
To validate result obtained from pySailingVLM two different wings were tested: swept Bertin wing and rectangular plat one.

\sphinxstepscope


\section{Rectangular flat plate}
\label{\detokenize{chapters/validation/flat_plate:rectangular-flat-plate}}\label{\detokenize{chapters/validation/flat_plate::doc}}
\sphinxAtStartPar
Using pySailingVLm a rectangular flat plate was modeled with a span of 10 units and a constant chord of 1 unit. The geomery of sail is discretized into 16 spanwise and 8 chordwise panels. The free\sphinxhyphen{}stream strength is 1 unit and the angle of attack is \(10^\circ\). Then the lift coefficient slope  \(C_{L,\alpha}\) was compared with {[}\hyperlink{cite.chapters/bibliography:id3}{AH13}{]} and analitically derived results in the table below.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Results from pySailingVLM code of the rectangular flat plate of a slope }\label{\detokenize{chapters/validation/flat_plate:comp}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
Analitical
&\sphinxstyletheadfamily 
\sphinxAtStartPar
{[}\hyperlink{cite.chapters/bibliography:id3}{AH13}{]}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
pySailingVLM
\\
\hline
\sphinxAtStartPar
\(C_{L,\alpha}\)
&
\sphinxAtStartPar
4.896
&
\sphinxAtStartPar
4.786
&
\sphinxAtStartPar
4.846
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=400\sphinxpxdimen]{{flat_cp}.png}
\caption{Pressure coefficients for flat plate. Figure generated by pySailingVLM.}\label{\detokenize{chapters/validation/flat_plate:flat-cp}}\end{figure}

\sphinxAtStartPar
????????????????????? dac cp plot z magisterki??????????????????????????????


\subsection{Results}
\label{\detokenize{chapters/validation/flat_plate:results}}
\sphinxAtStartPar
The results obtained by pySailingVLM are close to analitical and also {[}\hyperlink{cite.chapters/bibliography:id3}{AH13}{]} data. It should be noticed that analytically derived results assumes a span efficiency factor of 0.8.

\sphinxAtStartPar
????????????????????????? DAC wzor gdzies????????????????????

\sphinxstepscope


\section{Sweep wing}
\label{\detokenize{chapters/validation/sweep:sweep-wing}}\label{\detokenize{chapters/validation/sweep::doc}}
\sphinxAtStartPar
Swept wing by Bertin {[}\hyperlink{cite.chapters/bibliography:id5}{JJB09}{]}, is a flat plate with a \(45^\circ\) leading edge sweeping angle. The span of wing is 1 unit and a chord of 0.2 unit. Model was discretized into 4 spanwise panels and 1 chordwise panel. The free stream is aligned with the x\sphinxhyphen{}axis and has a magnitude of 1 units.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Comparison between swept wing by Bertin and pySailingVLM results.}\label{\detokenize{chapters/validation/sweep:comp-sweep}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
\sphinxAtStartPar
Bertin
&\sphinxstyletheadfamily 
\sphinxAtStartPar
pySailingVLM
\\
\hline
\sphinxAtStartPar
\(C_{L,\alpha}\)
&
\sphinxAtStartPar
3.443
&
\sphinxAtStartPar
3.434
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{bertin_1}.png}
\caption{Lift coefficient versus angle of attack. Figure generated by pySailingVLM.}\label{\detokenize{chapters/validation/sweep:bertin-1}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{bertin_2}.png}
\caption{Comparison of spanwise lift distributionfor the Bertin wing. Figure generated by pySailingVLM.}\label{\detokenize{chapters/validation/sweep:bertin-2}}\end{figure}

\sphinxAtStartPar
????????????????????????
TODO
Dodatkowy wykres za Katzem: https://www.researchgate.net/publication/245355607\_Calculation\_of\_the\_Aerodynamic\_Forces\_on\_Automotive\_Lifting\_Surfaces
Fig4


\section{Results}
\label{\detokenize{chapters/validation/sweep:results}}
\sphinxAtStartPar
Results obtained by pySailingVLM are close to teoretical results taken from {[}\hyperlink{cite.chapters/bibliography:id5}{JJB09}{]}.
When the angle of attack increases, the lift coefficient calculated by pySailingVLM differ from Bertin results (figure \hyperref[\detokenize{chapters/validation/sweep:bertin-1}]{\ref{\detokenize{chapters/validation/sweep:bertin-1}}}). It can be related with a small\sphinxhyphen{}angle approximation used in the Vortex Lattice Method, where the angle of attack and the angle of sideslip should be both small.
??????????????????????????????????????????

\sphinxstepscope


\chapter{Future outlooks}
\label{\detokenize{chapters/future:future-outlooks}}\label{\detokenize{chapters/future::doc}}
\sphinxAtStartPar
Some improvements to pySailingVLM code can be conducted in order to decrease program time execution.


\section{GPU}
\label{\detokenize{chapters/future:gpu}}
\sphinxAtStartPar
Apart form CPU programing, Numba supports CUDA GPU programming by directly compiling a restricted subset of Python code into CUDA kernels and device functions using the CUDA execution model. Kernels which are written in Numba appear to have direct access to NumPy arrays according to documantation {[}\hyperlink{cite.chapters/bibliography:id14}{num}{]}. The NumPy arrays are automatically shifted between the CPU and the GPU. To increase code performance, calcuations can be moved to GPU.


\section{All code as SoA}
\label{\detokenize{chapters/future:all-code-as-soa}}
\sphinxAtStartPar
Up to now, most of Python objects are represented as Structure of Arrays, except panels. To take full adventage of GPU speed up, panels can be rewriten into SoA. This memory layout is recommended for CUDA acceleration {[}\hyperlink{cite.chapters/bibliography:id13}{WP16}{]} due to parallel acces to data units.


\section{Points dupllicate}
\label{\detokenize{chapters/future:points-dupllicate}}
\sphinxAtStartPar
Panels which are close to each other share same points (see figure \hyperref[\detokenize{chapters/future:future-panels}]{\ref{\detokenize{chapters/future:future-panels}}}). Current pySailingVLM implementation do not take into account this fact and there are duplicates of points coordinates in panel array. Reducing redundant points can improve the code efficiency.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=500\sphinxpxdimen]{{future_drawio}.png}
\caption{Points on panels arragement. Figure created by author.}\label{\detokenize{chapters/future:future-panels}}\end{figure}

\sphinxstepscope


\chapter{Conclusions}
\label{\detokenize{chapters/conclusion:conclusions}}\label{\detokenize{chapters/conclusion::doc}}
\sphinxAtStartPar
pySailingVLM package created for initial aerodynamic analysis of upwind sails can be useful in
early conceptual phase, when many different desings should be tested. Numba with ‘non\sphinxhyphen{}objective’ pySailingVLM code gives satisfying acceleration results in comparison to objective code. Data generated by this package is close to theory and other tools {[}\hyperlink{cite.chapters/bibliography:id3}{AH13}{]}. It has light weight requirements and can be run locally or in a cloud environment such as Google Collab. Apart from this, users can define own sail geometries and visualize obtained results.

\sphinxstepscope


\chapter{Bibliography}
\label{\detokenize{chapters/bibliography:bibliography}}\label{\detokenize{chapters/bibliography::doc}}
\begin{sphinxthebibliography}{NJS+21}
\bibitem[num]{chapters/bibliography:id14}
\sphinxAtStartPar
Numba documentation {[}access: 08.06.2023{]}. URL: \sphinxurl{https://numba.pydata.org/numba-doc/latest/index.html}.
\bibitem[AH13]{chapters/bibliography:id3}
\sphinxAtStartPar
T.Larsson A. Helmstad. \sphinxstyleemphasis{An Aeroelastic Implementation for Yacht Sails and Rigs, Degree project in Naval Architecture}. KTH Engeneering Sciences, 2013.
\bibitem[AS20]{chapters/bibliography:id12}
\sphinxAtStartPar
H. Amiri and A. Shahbahrami. Simd programming using intel vector extensions. \sphinxstyleemphasis{Journal of Parallel and Distributed Computing}, pages 83–100, 2020. URL: \sphinxurl{https://www.sciencedirect.com/science/article/pii/S074373151830813X}, \sphinxhref{https://doi.org/10.1016/j.jpdc.2019.09.012}{doi:10.1016/j.jpdc.2019.09.012}.
\bibitem[Gru21]{chapters/bibliography:id7}
\sphinxAtStartPar
G. Gruszczyński. Constrained optimization of an upwind sail set using fast solver. In \sphinxstyleemphasis{Lecture: 2.016 Hydrodynamics}. Interdisciplinary Center for Mathematical and Computational Modelling, University of Warsaw, 2021.
\bibitem[JK01]{chapters/bibliography:id4}
\sphinxAtStartPar
A. Plotkin J. Katz. \sphinxstyleemphasis{Low\sphinxhyphen{}Speed Aerodynamics, Second Edition}. Cambridge University Press, 2001.
\bibitem[JJB09]{chapters/bibliography:id5}
\sphinxAtStartPar
Russell M. Cummings John J. Bertin. \sphinxstyleemphasis{Aerodynamics for engineers, Fifth Edition}. Pearson Education International, 2009.
\bibitem[NJS+21]{chapters/bibliography:id9}
\sphinxAtStartPar
Sheharyar Nasir, M Tariq Javaid, M. Usman Shahid, Asad Raza, Waseeq Siddiqui, and Shuaib Salamat. Applicability of vortex lattice method and its comparison with high fidelity tools. \sphinxstyleemphasis{Pakistan Journal of Engineering and Technology, PakJET}, 04(01):207– 211, 2021. URL: \sphinxurl{https://www.hpej.net/journals/pakjet/article/view/754/564}, \sphinxhref{https://doi.org/DOI: 10.51846/vol4iss1pp207-211}{doi:DOI: 10.51846/vol4iss1pp207\sphinxhyphen{}211}.
\bibitem[NS18]{chapters/bibliography:id2}
\sphinxAtStartPar
Bill Gladstone North Sails. Twist explained. 2018. URL: \sphinxurl{https://www.northsails.com/sailing/en/2018/10/north-u-understanding-twist-by-bill-gladstone} (visited on 2021\sphinxhyphen{}11\sphinxhyphen{}07).
\bibitem[PHW+13]{chapters/bibliography:id11}
\sphinxAtStartPar
S.J. Pennycooka, S.D. Hammondb, S.A. Wright, J.A. Herdmanc, I. Millerc, and S.A. Jarvis. An investigation of the performance portability of opencl. \sphinxstyleemphasis{Journal of Parallel and Distributed Computing}, 73:439–1450, November 2013. URL: \sphinxurl{https://www.sciencedirect.com/science/article/abs/pii/S0743731512001669}, \sphinxhref{https://doi.org/0.1016/j.jpdc.2012.07.005}{doi:0.1016/j.jpdc.2012.07.005}.
\bibitem[PS00]{chapters/bibliography:id8}
\sphinxAtStartPar
W. F. Phillips and D. O. Snyder. Modern adaptation of prandtl's classic lifting\sphinxhyphen{}line theory. \sphinxstyleemphasis{JOURNAL OF AIRCRAFT}, 37(4):662–670, July \sphinxhyphen{} August 2000. URL: \sphinxurl{http://arc.aiaa.org}, \sphinxhref{https://doi.org/DOI: 10.2514/2.2649}{doi:DOI: 10.2514/2.2649}.
\bibitem[SHR+19]{chapters/bibliography:id10}
\sphinxAtStartPar
A. Septiyana, K. Hidayat, A. Rizaldi, M. L. Ramadiansyah, R. A. Ramadhan, P. A. P. Suseno, E. B. Jayanti, N. Atmasari, and A. Rasyadi. Analysis of aerodynamic characteristics using the vortex lattice method on twin tail boom unmanned aircraft. \sphinxstyleemphasis{7TH INTERNATIONAL SEMINAR ON AEROSPACE SCIENCE AND TECHNOLOGY \sphinxhyphen{} ISAST 2019}, 2226(April):536, 24\sphinxhyphen{}25 September 2019. URL: \sphinxurl{https://pubs.aip.org/aip/acp/article/2226/1/020003/814546/Analysis-of-aerodynamic-characteristics-using-the}, \sphinxhref{https://doi.org/10.1063/5.0002337}{doi:10.1063/5.0002337}.
\bibitem[Tec05]{chapters/bibliography:id6}
\sphinxAtStartPar
Prof. A.H. Techet. Potential flow theory. In \sphinxstyleemphasis{Lecture: 2.016 Hydrodynamics}. Massachusetts Institute of Technology, 2005. MIT. URL: \sphinxurl{https://web.mit.edu/2.016/www/handouts/2005Reading4.pdf}.
\bibitem[WP16]{chapters/bibliography:id13}
\sphinxAtStartPar
A. Wells and A. M. Prabha. Improve vectorization efficiency using intel simd data layout template (intel sdlt) {[}access: 08.06.2023{]}. In \sphinxstyleemphasis{INTEL HPC DEVELOPER CONFERENCE FUEL YOUR INSIGHT}. Novenber 2016. URL: \sphinxurl{https://www.intel.com/content/dam/www/public/us/en/documents/presentation/improving-vectorization-efficiency.pdf}.
\end{sphinxthebibliography}







\renewcommand{\indexname}{Index}
\printindex
\end{document}